# Compilador y opciones
CC = gcc
CFLAGS = -Wall -g
LDFLAGS = -lpthread

# Directorios
SRC_DIR = src
BIN_DIR = bin

# Nombres base
TARGETS = Broker Producer Consumer

# Rutas completas a ejecutables
EXECS = $(addprefix $(BIN_DIR)/, $(TARGETS))

# Regla por defecto (hace todo)
all: install

# Compila cada ejecutable
$(BIN_DIR)/%: $(SRC_DIR)/%.c | $(BIN_DIR)
	$(CC) $(CFLAGS) -o $@ $< $(LDFLAGS)

# Crear bin/ si no existe
$(BIN_DIR):
	mkdir -p $(BIN_DIR)

# Instala (compila y muestra confirmaciÃ³n)
install: $(EXECS)
	@echo "Ejecutables generados correctamente en $(BIN_DIR):"
	@ls -1 $(BIN_DIR)

# Limpia
clean:
	rm -rf $(BIN_DIR)
